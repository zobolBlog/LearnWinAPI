<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/603279 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="8256"/>

<div>
<span><div><b><font style="font-size: 12pt;">1.windows编程入门MessageBox使用 -zobol的windows编程教程</font></b></div><div><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;">    引言：</span><span style="font-size: unset; color: unset; font-family: unset;">刚开始入门windows编程的时候，我记得当时我对MFC的给出的一大堆代码感到束手无策。因为历史的缘故，windows编程入门的代码并没有体现出C++语言的简洁性，相反一上来就给了我们一大堆代码、类和宏。不过，我还是喜欢C＋＋的入门“hello world”的简洁，所以我编写了一个简单的入门小程序，辅以详细的注释讲解。</span></div><div>    <span style="font-weight: bold;">个人技术博客（文章整理＋源码）：</span> <a href="https://zobolblog.github.io/LearnWinAPI/" style="box-sizing: border-box; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: var(--color-accent-fg); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal;">https://zobolblog.github.io/LearnWinAPI/</a></div><div>    <span style="font-weight: bold;">最终效果：</span></div><div style="text-align: center;"><img src="1.windows编程入门MessageBox使用 -zobol的windows编程教程_files/Image.png" type="image/png" data-filename="Image.png" width="323"/></div><div style="text-align: center;"><br/></div><div><br/></div><div><span style="font-weight: bold;">1.调整项目属性设置。</span></div><div>    因为我们写的是一个窗口windows程序，而不是之前C++的dos黑框框程序，所以我们需要调整vs的项目属性-链接器-系统-子系统，讲subsystem设置为窗口。</div><div style="text-align: center;"><img src="1.windows编程入门MessageBox使用 -zobol的windows编程教程_files/Image [1].png" type="image/png" data-filename="Image.png" width="621"/></div><div>    如果不修改，会遇到error，因为在控制台模式下，程序会寻找main函数作为起始函数，而windows窗口程序的起始函数是WinMain。</div><div style="text-align: center;"><img src="1.windows编程入门MessageBox使用 -zobol的windows编程教程_files/Image [2].png" type="image/png" data-filename="Image.png" width="486"/></div><div style="text-align: center;"><br/></div><div style="text-align: left;"><span style="font-weight: bold;">2.引入头文件windows.h</span></div><div style="text-align: left;">    微软对windows的庞大api做了很好的头文件封装，我们只需要一个windows.h就可以使用大部分功能。</div><div style="text-align: left;">    </div><div style="text-align: left;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#include &quot;windows.h&quot;</div></div><div><br/></div></div><div style="text-align: left;">    你可以，右键打开windows.h文档简单看一下，不过它编写的并不适合查询，查询可以使用微软的官方Doc:<a href="https://docs.microsoft.com/zh-cn/">https://docs.microsoft.com/zh-cn/</a></div><div style="text-align: left;"><br/></div><div style="text-align: left;">3<span style="font-weight: bold;">.编写起始函数WinMain</span></div><div style="text-align: left;">    dos程序的起始点是main函数，windows窗口程序的起始函数是WinMain函数。它增加了很多宏和参数，不过不用担心，你只需要复制就可以，这些宏的意思后面我会讲。它们基本上在所有程序中，写法都一样，所以这里复制就可以，只需要知道它相当于Main。</div><div style="text-align: left;"><br/></div><div style="text-align: left;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int WINAI WinMain (</div><div>    _In_ HINSTANCE hInstance,</div><div>    _In_opt_ HINSTANCE hPrevInstance,</div><div>    _In_ LPSTR lpCmdLine,</div><div>    _In_ int nShowCmd</div><div>    );</div></div></div><div style="text-align: left;"><span style="font-weight: bold;">4.接触第一个消息框函数MessageBox</span></div><div style="text-align: left;">    Message函数刚开始使用起来，感觉有点类似于printf，它可以把信息显示给用户。但实际上printf是格式化输出函数，Message实际上是拉起一个小的信息窗口windows。不过，刚开始学习的话，都可以将它看作是windows版的信息打印函数。</div><div style="text-align: left;"><br/></div><div style="text-align: left;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int MessageBox(</div><div>    HWND hWnd,</div><div>    LPCTSTR lpText,</div><div>    LPCTSTR lpCaption,</div><div>    UINT uType</div><div>    )</div></div><div><br/></div></div><div style="text-align: left;">    第1个HWND hWnd是所属句柄，也就是这个消息框所属于哪个父窗口，这里我们填NULL就好，默认属于桌面。</div><div style="text-align: left;">    第2个LPCTSTR lpText,是窗口显示的内容。</div><div style="text-align: left;">    第3个LPCTSTR lpCaption是窗口的标题</div><div style="text-align: left;">    第4个UINT uType是消息框的类型，微软内置了多种消息框的类型，通过宏来切换。</div><div style="text-align: left;"><br/></div><div style="text-align: left;"><span style="font-weight: bold;">5.消息框的UINT uType类型</span></div><div style="text-align: left;">    INT uType本质是个枚举宏，一共有二十多种，部分可以重叠生效用A|B来表示。</div><div style="text-align: center;"><img src="1.windows编程入门MessageBox使用 -zobol的windows编程教程_files/Image [3].png" type="image/png" data-filename="Image.png" width="339"/></div><div style="text-align: left;">    具体可以查询官方目录：<a href="https://docs.microsoft.com/zh-CN/windows/win32/api/winuser/nf-winuser-messagebox">https://docs.microsoft.com/zh-CN/windows/win32/api/winuser/nf-winuser-messagebox</a></div><div style="text-align: left;"><br/></div><div><span style="font-weight: bold;">源码：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#include &quot;windows.h&quot;</div><div>int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance,LPSTR lpCmdLine,int  nCmdShow)</div><div>{</div><div>       MessageBox(NULL, L&quot;zobol的windows基础教程&quot;, L&quot;第一个窗口&quot;,MB_ABORTRETRYIGNORE |  MB_ICONASTERISK);</div><div>}</div></div><div><br/></div><div><span style="font-weight: bold;">效果：</span></div><div style="text-align: center;">    <img src="1.windows编程入门MessageBox使用 -zobol的windows编程教程_files/Image [4].png" type="image/png" data-filename="Image.png" width="318"/></div><div><br/></div><div>    <span style="font-weight: bold;">本人个人技术博客</span>： <a href="https://zobolblog.github.io/LearnWinAPI/" style="box-sizing: border-box; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: var(--color-accent-fg); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal; text-decoration: underline;">https://zobolblog.github.io/LearnWinAPI/</a> ，B站账号：zobol，个人公众号：zobol的魔法藏书室，技术讨论群:811851762。所有源码和文章均整理上传其中，欢迎关注。</div><div><br/></div><div>    本文参考资料：<a href="https://docs.microsoft.com/zh-CN/windows/win32/api/winuser/nf-winuser-messagebox">https://docs.microsoft.com/zh-CN/windows/win32/api/winuser/nf-winuser-messagebox</a></div></span>
</div></body></html> 